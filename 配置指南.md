# 研究热点分析工具 - 配置指南

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置 API Key

#### 获取 Qwen API Key

1. 访问阿里云 DashScope 控制台：https://dashscope.console.aliyun.com/
2. 注册/登录账号
3. 创建 API Key
4. 复制你的 API Key

#### 配置方式

**方式 A：使用 .env 文件（推荐）**

1. 复制示例文件：
```bash
copy .env.example .env
```

2. 编辑 `.env` 文件，填入你的 API Key：
```
LLM_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
LLM_ENDPOINT=https://dashscope.aliyuncs.com/compatible-mode/v1
```

3. 保存文件

**方式 B：设置环境变量**

Windows PowerShell:
```powershell
$env:LLM_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxx"
$env:LLM_ENDPOINT="https://dashscope.aliyuncs.com/compatible-mode/v1"
```

Windows CMD:
```cmd
set LLM_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
set LLM_ENDPOINT=https://dashscope.aliyuncs.com/compatible-mode/v1
```

### 3. 运行应用

```bash
streamlit run app.py
```

应用会自动在浏览器中打开。

## 使用说明

1. **输入研究领域关键词**
   - 例如："量子计算"、"人工智能"、"深度学习"

2. **选择时间范围**
   - 起始年月：例如 2023-01
   - 结束年月：例如 2024-12

3. **点击"分析"按钮**
   - 系统会从 OpenAlex 获取论文数据
   - 使用 LLM 提取关键词
   - 生成关键词共现热力图

4. **查看结果**
   - 热力图显示关键词之间的共现关系
   - 颜色越深表示共现频率越高

## 功能说明

### 完整功能（配置 LLM API Key）
- ✅ 一区期刊识别
- ✅ 智能关键词提取
- ✅ 关键词共现分析
- ✅ 热力图可视化

### 基础功能（未配置 LLM API Key）
- ✅ OpenAlex 数据获取
- ❌ 期刊过滤（跳过）
- ❌ 关键词提取（无法生成热力图）

## 中文显示问题

### 如果热力图中文显示为方框

应用已自动配置中文字体支持，但如果仍然出现乱码，可以：

**Windows 系统：**
- 系统会自动使用 SimHei（黑体）或 Microsoft YaHei（微软雅黑）
- 这些字体通常已预装在 Windows 系统中

**Mac 系统：**
- 系统会尝试使用 Arial Unicode MS
- 如果仍有问题，可以安装中文字体

**Linux 系统：**
```bash
# Ubuntu/Debian
sudo apt-get install fonts-wqy-zenhei

# 或安装其他中文字体
sudo apt-get install fonts-noto-cjk
```

安装字体后，重启应用即可。

## 常见问题

### Q: 提示 "未配置 LLM API 密钥"
**A:** 需要配置 API Key，参考上面的配置步骤。

### Q: 提示 "未找到 OpenAlex 数据"
**A:** 可能原因：
- 关键词太具体，没有匹配的论文
- 时间范围内没有相关论文
- 网络连接问题

建议：
- 尝试更通用的关键词
- 扩大时间范围
- 检查网络连接

### Q: 关键词提取失败
**A:** 可能原因：
- API Key 配置错误
- API 额度不足
- 网络连接问题

建议：
- 检查 API Key 是否正确
- 检查阿里云账户余额
- 检查网络连接

### Q: 热力图显示不清晰
**A:** 可能原因：
- 关键词数量太多
- 共现关系太少

建议：
- 在侧边栏调整"最大关键词数量"（默认30，范围10-50）
- 缩小时间范围
- 使用更具体的领域关键词

### Q: 提示图片大小超限错误
**A:** 这是因为关键词数量太多导致图片过大。

解决方案：
- 系统已自动限制最大关键词数量为50个
- 可以在侧边栏调整"最大关键词数量"滑块
- 建议设置为20-30个关键词以获得最佳显示效果
- 系统会自动选择出现频率最高的关键词

## 技术支持

如有问题，请检查：
1. Python 版本 >= 3.9
2. 所有依赖已正确安装
3. API Key 配置正确
4. 网络连接正常

## 数据来源

- **OpenAlex**: 免费开放的学术论文数据库
- **Qwen LLM**: 阿里云通义千问大语言模型
